diff -urN DirectFB-1.6.1/src/core/surface.c DirectFB-1.6.1-patched/src/core/surface.c
--- DirectFB-1.6.1/src/core/surface.c	2012-06-30 03:01:11.000000000 +1100
+++ DirectFB-1.6.1-patched/src/core/surface.c	2012-08-08 18:35:58.496352083 +1100
@@ -49,6 +49,9 @@
 #include <gfx/convert.h>
 #include <gfx/util.h>
 
+#ifdef USE_ZLIB
+#include <zlib.h>
+#endif
 
 D_DEBUG_DOMAIN( Core_Surface, "Core/Surface", "DirectFB Core Surface" );
 
